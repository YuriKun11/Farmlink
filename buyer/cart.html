<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <!-- Cart Container -->
<div id="cart-container">
    <h2>Your Cart</h2>
    <table id="cart-table" class="table-auto w-full border-collapse">
        <thead>
            <tr>
                <th class="border px-4 py-2">Image</th>
                <th class="border px-4 py-2">Product</th>
                <th class="border px-4 py-2">Price</th>
                <th class="border px-4 py-2">Quantity</th>
                <th class="border px-4 py-2">Total</th>
            </tr>
        </thead>
        <tbody>
            <!-- Cart items will be inserted here -->
        </tbody>
    </table>
    <div id="cart-total">
        <p><strong>Total: ₱<span id="total-amount">0.00</span></strong></p>
    </div>
</div>

<script>
    window.onload = function() {
        fetchCart();
    };

    function fetchCart() {
        fetch('../backend/get_cart.php')
            .then(res => res.json())
            .then(data => {
                if (data.status === 'success') {
                    displayCartItems(data.cart_items);
                } else {
                    console.error('Failed to fetch cart:', data.message);
                }
            })
            .catch(error => {
                console.error('Error fetching cart:', error);
            });
    }

   
    function displayCartItems(cartItems) {
    const cartTableBody = document.getElementById('cart-table').getElementsByTagName('tbody')[0];
    let totalAmount = 0;

    cartItems.forEach(item => {
        const row = document.createElement('tr');
        const imageCell = document.createElement('td');
        imageCell.classList.add('border', 'px-4', 'py-2', 'text-center');
        const img = document.createElement('img');

        img.src = `../backend/${item.image_url}`; 
        img.alt = item.title;
        img.classList.add('w-20', 'h-20', 'object-cover'); 
        imageCell.appendChild(img);

        const productCell = document.createElement('td');
        productCell.classList.add('border', 'px-4', 'py-2');
        productCell.textContent = item.title;

        const price = parseFloat(item.price);
        const priceCell = document.createElement('td');
        priceCell.classList.add('border', 'px-4', 'py-2');
        priceCell.textContent = `₱${price.toFixed(2)}`;

        const quantityCell = document.createElement('td');
        quantityCell.classList.add('border', 'px-4', 'py-2');
        quantityCell.textContent = item.quantity;

        const totalCell = document.createElement('td');
        totalCell.classList.add('border', 'px-4', 'py-2');
        const total = parseFloat(item.total_price).toFixed(2);
        totalCell.textContent = `₱${total}`;

        row.appendChild(imageCell);
        row.appendChild(productCell);
        row.appendChild(priceCell);
        row.appendChild(quantityCell);
        row.appendChild(totalCell);

        cartTableBody.appendChild(row);
        totalAmount += parseFloat(item.total_price);
    });
    document.getElementById('total-amount').textContent = totalAmount.toFixed(2);
}
</script>

</body>
</html>